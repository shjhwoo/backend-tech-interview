# 명령어 병렬 처리 기법

CPU가 놀지 않고 시간을 알뜰하게 쓰며 작동하게 만드는 것도 중요함

아래와 같은 방법으로 명령어들을 실행할 수 있다

- 명령어 파이프라이닝
- 슈퍼스칼라
- 비순차적 명령어처리

## 명령어 파이프라이닝

CPU는 명령어의 각 실행 단계가 겹치지만 않는다면 여러 개의 명령어를 실행할 수 있다.
명령어는 보통 다음과 같은 순서를 거쳐 실행되기 떄문이다.
인출 > 해석 > 실행 > 결과 저장

이는 마치 공장의 컨베이어와도 같은 것

단 다음과 같은 단점이 있음

- 데이터 위험
- 제어 위험
- 구조적 위험

### 데이터 위험

명령어간 데이터 의존성 문제가 원인이다.
첫번째 명령어를 실행한 결과를 필요로 하는 명령어 2를 첫번째 명령어와 같이 실행할 수는 없다.

### 제어 위험

분기 등으로 인한 프로그램 카운터가 갑작스럽게 변화가 있을 경우 발생한다.
보통 명령어 실행 후 다음 주소로 프로그램 카운터가 갱신되지만
분기문이 있을 경우에는 카운터 값이 갑자기 바뀌므로 무용지물이 된다.
이를 보완하기 위해, 프로그램이 어디로 분기할지 미리 예측하는 기술도 있다. : 분기예측.

### 구조적 위험

명령어들을 겹쳐 실행하는 과정에서 서로 다른 명령어가 동시에 같은 CPU 부품을 사용하려고 할 때 발생한다.
자원 위험이라고도 한다.

## 슈퍼스칼라

컨베이어 벨트를 여러개 두는 것과 같다. 즉, 여러개의 파이프라인을 사용하는 것이다.
즉, 매 클럭 주기마다 동시에 명령어를 인출하고 실행할 수도 있다.
이론적으로는 여러개의 파이프라인을 사용하므로 개수에 비례해서 명령어 처리속도가 빠를거라고 생각할 수 있지만,
이를 사용하는 프로세서는 파이프라이닝에서 발생하는 문제가 생기지 않도록 매우 고도로 설계되어야 한다.

## 비순차적 명령어 처리

명령어 여러개가 있을 때 굳이 순서를 지키지 않아도 결과에 영향을 안주는 명령어가 있다면 순서를 다른 명령어와 바꿔 실행하는게 오히려 더 빠를 수 있다.
요즘 나오는 CPU에는 이런 기법이 적용되었기 때문에 꼭 알아둘 필요가 있다.
